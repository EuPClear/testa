-- EUP HUB - ESP & Aimbot com Abas, Minimizar (Shift Direito), RGB TÃ­tulo, Wall Check e Sliders
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

local ESPEnabled = false
local AimbotEnabled = false
local ESPBoxes = {}
local ESPNames = {}
local ESPColor = Color3.fromRGB(255, 80, 80)
local NameColor = Color3.fromRGB(255, 255, 255)
local FOVSize = 150
local BoxSizeMultiplier = 1
local HubVisible = true

local FOVCircle = Drawing.new("Circle")
FOVCircle.Color = Color3.fromRGB(85, 170, 255)
FOVCircle.Thickness = 1
FOVCircle.NumSides = 100
FOVCircle.Radius = FOVSize
FOVCircle.Filled = false
FOVCircle.Visible = false

local function createSlider(parent, text, min, max, default, callback)
    local label = Instance.new("TextLabel", parent)
    label.Size = UDim2.new(0, 200, 0, 20)
    label.Text = text .. ": " .. tostring(default)
    label.TextColor3 = Color3.new(1,1,1)
    label.BackgroundTransparency = 1

    local slider = Instance.new("TextBox", parent)
    slider.Size = UDim2.new(0, 200, 0, 30)
    slider.Text = tostring(default)
    slider.TextColor3 = Color3.new(1,1,1)
    slider.BackgroundColor3 = Color3.fromRGB(45,45,45)
    slider.ClearTextOnFocus = false

    slider.FocusLost:Connect(function()
        local val = tonumber(slider.Text)
        if val then
            val = math.clamp(val, min, max)
            callback(val)
            label.Text = text .. ": " .. tostring(val)
        end
    end)
end

-- Interface
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "EUP_HUB"
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 400, 0, 300)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true

local Tabs = Instance.new("Frame", MainFrame)
Tabs.Size = UDim2.new(1, 0, 0, 30)
Tabs.BackgroundTransparency = 1

local function createTabButton(name, position)
    local button = Instance.new("TextButton", Tabs)
    button.Size = UDim2.new(0, 100, 0, 30)
    button.Position = position
    button.Text = name
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    button.BorderSizePixel = 0
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    return button
end

local WelcomeTab = Instance.new("Frame", MainFrame)
WelcomeTab.Size = UDim2.new(1, 0, 1, -30)
WelcomeTab.Position = UDim2.new(0, 0, 0, 30)
WelcomeTab.BackgroundTransparency = 1

local ESPTab = Instance.new("Frame", MainFrame)
ESPTab.Size = WelcomeTab.Size
ESPTab.Position = WelcomeTab.Position
ESPTab.BackgroundTransparency = 1

local AimbotTab = Instance.new("Frame", MainFrame)
AimbotTab.Size = WelcomeTab.Size
AimbotTab.Position = WelcomeTab.Position
AimbotTab.BackgroundTransparency = 1

local Title = Instance.new("TextLabel", WelcomeTab)
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Position = UDim2.new(0, 0, 0, 30)
Title.Text = "EUP HUB"
Title.TextScaled = true
Title.BackgroundTransparency = 1

local hue = 0
RunService.RenderStepped:Connect(function()
    hue = (hue + 1) % 255
    Title.TextColor3 = Color3.fromHSV(hue / 255, 1, 1)
end)

local espButton = Instance.new("TextButton", ESPTab)
espButton.Size = UDim2.new(0, 200, 0, 40)
espButton.Position = UDim2.new(0.5, -100, 0, 10)
espButton.Text = "Toggle ESP"
espButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
espButton.TextColor3 = Color3.fromRGB(255, 255, 255)
espButton.MouseButton1Click:Connect(function()
    ESPEnabled = not ESPEnabled
end)

createSlider(ESPTab, "FOV Size", 50, 500, FOVSize, function(val)
    FOVSize = val
    FOVCircle.Radius = val
end)

createSlider(ESPTab, "Box Size", 0.5, 3, BoxSizeMultiplier, function(val)
    BoxSizeMultiplier = val
end)

local aimbotButton = Instance.new("TextButton", AimbotTab)
aimbotButton.Size = UDim2.new(0, 200, 0, 40)
aimbotButton.Position = UDim2.new(0.5, -100, 0, 10)
aimbotButton.Text = "Toggle Aimbot"
aimbotButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
aimbotButton.TextColor3 = Color3.fromRGB(255, 255, 255)
aimbotButton.MouseButton1Click:Connect(function()
    AimbotEnabled = not AimbotEnabled
end)

local welcomeBtn = createTabButton("Welcome", UDim2.new(0, 0, 0, 0))
local espBtn = createTabButton("ESP", UDim2.new(0, 100, 0, 0))
local aimBtn = createTabButton("Aimbot", UDim2.new(0, 200, 0, 0))

local function showTab(tab)
    WelcomeTab.Visible = false
    ESPTab.Visible = false
    AimbotTab.Visible = false
    tab.Visible = true
end

welcomeBtn.MouseButton1Click:Connect(function() showTab(WelcomeTab) end)
espBtn.MouseButton1Click:Connect(function() showTab(ESPTab) end)
aimBtn.MouseButton1Click:Connect(function() showTab(AimbotTab) end)

showTab(WelcomeTab)

UserInputService.InputBegan:Connect(function(input, processed)
    if input.KeyCode == Enum.KeyCode.RightShift then
        HubVisible = not HubVisible
        MainFrame.Visible = HubVisible
    end
end)

local function getClosestTarget()
    local closest, shortest = nil, math.huge
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Team ~= LocalPlayer.Team and player.Character and player.Character:FindFirstChild("Head") then
            local head = player.Character.Head
            local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
            local distance = (Vector2.new(screenPos.X, screenPos.Y) - UserInputService:GetMouseLocation()).Magnitude

            if onScreen and distance < FOVSize and distance < shortest then
                local origin = Camera.CFrame.Position
                local direction = (head.Position - origin).Unit * 500
                local raycastParams = RaycastParams.new()
                raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
                raycastParams.FilterDescendantsInstances = {LocalPlayer.Character}
                raycastParams.IgnoreWater = true

                local result = workspace:Raycast(origin, direction, raycastParams)
                if result and result.Instance and result.Instance:IsDescendantOf(player.Character) then
                    closest = player
                    shortest = distance
                end
            end
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function()
    FOVCircle.Position = UserInputService:GetMouseLocation()
    FOVCircle.Visible = AimbotEnabled

    for _, v in pairs(ESPBoxes) do v.Visible = false end
    for _, v in pairs(ESPNames) do v.Visible = false end

    if ESPEnabled then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Team ~= LocalPlayer.Team then
                local hrp = player.Character.HumanoidRootPart
                local origin = Camera.CFrame.Position
                local direction = (hrp.Position - origin).Unit * 500
                local raycastParams = RaycastParams.new()
                raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
                raycastParams.FilterDescendantsInstances = {LocalPlayer.Character}
                raycastParams.IgnoreWater = true

                local result = workspace:Raycast(origin, direction, raycastParams)
                if result and result.Instance and result.Instance:IsDescendantOf(player.Character) then
                    local pos, onscreen = Camera:WorldToViewportPoint(hrp.Position)
                    if onscreen then
                        if not ESPBoxes[player] then
                            ESPBoxes[player] = Drawing.new("Square")
                            ESPBoxes[player].Thickness = 2
                            ESPBoxes[player].Color = ESPColor
                            ESPBoxes[player].Filled = false
                            ESPNames[player] = Drawing.new("Text")
                            ESPNames[player].Size = 14
                            ESPNames[player].Color = NameColor
                            ESPNames[player].Center = true
                        end
                        local size = Vector3.new(2, 3, 1.5) * BoxSizeMultiplier
                        local topLeft = Camera:WorldToViewportPoint(hrp.Position - Vector3.new(size.X/2, -size.Y/2, 0))
                        ESPBoxes[player].Size = Vector2.new(60 * BoxSizeMultiplier, 100 * BoxSizeMultiplier)
                        ESPBoxes[player].Position = Vector2.new(topLeft.X, topLeft.Y)
                        ESPBoxes[player].Visible = true
                        ESPNames[player].Text = player.Name
                        ESPNames[player].Position = Vector2.new(topLeft.X + 30, topLeft.Y - 15)
                        ESPNames[player].Visible = true
                    end
                end
            end
        end
    end

    if AimbotEnabled then
        local target = getClosestTarget()
        if target and target.Character and target.Character:FindFirstChild("Head") then
            local head = target.Character.Head.Position
            local camPos = Camera.CFrame.Position
            local direction = (head - camPos).Unit
            Camera.CFrame = Camera.CFrame:Lerp(CFrame.new(camPos, camPos + direction), 0.15)
        end
    end
end)
